<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Password Reset - Library Management</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/static/css/admin-forgot-password.css">
</head>
<body>
    <div class="admin-forgot-container">
        <!-- Background -->
        <div class="background-blur"></div>

        <!-- Main Card -->
        <div class="forgot-card">
            <div class="card-header">
                <div class="logo">
                    <i class="fas fa-lock"></i>
                    <span>LibraryPro Admin</span>
                </div>
                <p class="subtitle">Secure Password Recovery</p>
            </div>

            <!-- Step 1: Email Verification -->
            <div id="step1-email" class="step active">
                <h2>Step 1: Verify Email</h2>
                <p class="step-description">Enter your admin email to get started</p>

                <form onsubmit="handleEmailSubmit(event)">
                    <div class="form-group">
                        <label>Admin Email Address</label>
                        <div class="input-wrapper">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="adminEmail" placeholder="admin@library.com" required>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-arrow-right"></i> Verify Email
                    </button>
                </form>

                <div class="help-link">
                    <a href="/admin/authentication/adminlogin.html">
                        <i class="fas fa-arrow-left"></i> Back to Login
                    </a>
                </div>
            </div>

            <!-- Step 2: 2FA Authentication -->
            <div id="step2-2fa" class="step">
                <h2>Step 2: Two-Factor Authentication</h2>
                <p class="step-description">Verify your identity using your authenticator app</p>

                <div class="security-info">
                    <div class="info-box">
                        <i class="fas fa-info-circle"></i>
                        <span>Enter the 6-digit code from your authenticator app (Google Authenticator, Microsoft Authenticator, or Authy)</span>
                    </div>
                </div>

                <form onsubmit="handle2FASubmit(event)">
                    <div class="form-group">
                        <label>2FA Authentication Code</label>
                        <div class="code-inputs">
                            <input type="text" class="code-input" maxlength="1" pattern="[0-9]" required>
                            <input type="text" class="code-input" maxlength="1" pattern="[0-9]" required>
                            <input type="text" class="code-input" maxlength="1" pattern="[0-9]" required>
                            <input type="text" class="code-input" maxlength="1" pattern="[0-9]" required>
                            <input type="text" class="code-input" maxlength="1" pattern="[0-9]" required>
                            <input type="text" class="code-input" maxlength="1" pattern="[0-9]" required>
                        </div>
                        <input type="hidden" id="fullCode">
                    </div>

                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-check"></i> Verify Code
                    </button>
                </form>

                <div class="alternative-auth">
                    <p>Don't have your authenticator?</p>
                    <button type="button" class="btn-link" onclick="showBackupCodes()">
                        Use Backup Code
                    </button>
                </div>

                <div class="help-link">
                    <button type="button" class="btn-back" onclick="goBackStep()">
                        <i class="fas fa-arrow-left"></i> Go Back
                    </button>
                </div>
            </div>

            <!-- Step 3: Backup Code (if needed) -->
            <div id="step3-backup" class="step">
                <h2>Using Backup Code</h2>
                <p class="step-description">Enter one of your backup codes</p>

                <form onsubmit="handleBackupCodeSubmit(event)">
                    <div class="form-group">
                        <label>Backup Code</label>
                        <div class="input-wrapper">
                            <i class="fas fa-key"></i>
                            <input type="text" id="backupCode" placeholder="XXXX-XXXX-XXXX-XXXX" required>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-check"></i> Verify Backup Code
                    </button>
                </form>

                <div class="help-link">
                    <button type="button" class="btn-back" onclick="goBackStep()">
                        <i class="fas fa-arrow-left"></i> Back to 2FA
                    </button>
                </div>
            </div>

            <!-- Step 4: Reset Password -->
            <div id="step4-reset" class="step">
                <h2>Step 3: Create New Password</h2>
                <p class="step-description">Set a strong password for your admin account</p>

                <div class="security-info">
                    <div class="info-box">
                        <i class="fas fa-shield-alt"></i>
                        <span>Password must be at least 12 characters, include uppercase, numbers, and special characters</span>
                    </div>
                </div>

                <form onsubmit="handlePasswordReset(event)">
                    <div class="form-group">
                        <label>New Password</label>
                        <div class="input-wrapper">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="newPassword" placeholder="••••••••••••" required>
                            <button type="button" class="toggle-password" onclick="togglePasswordVisibility('newPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="password-strength">
                            <div class="strength-bar" id="strengthBar"></div>
                            <span class="strength-text">Password strength: <strong id="strengthText">Very Weak</strong></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Confirm Password</label>
                        <div class="input-wrapper">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="confirmPassword" placeholder="••••••••••••" required>
                            <button type="button" class="toggle-password" onclick="togglePasswordVisibility('confirmPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-refresh"></i> Reset Password
                    </button>
                </form>

                <div class="help-link">
                    <button type="button" class="btn-back" onclick="goBackStep()">
                        <i class="fas fa-arrow-left"></i> Go Back
                    </button>
                </div>
            </div>

            <!-- Step 5: Success -->
            <div id="step5-success" class="step">
                <div class="success-animation">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                </div>

                <h2>Password Reset Successful!</h2>
                <p class="step-description">Your password has been successfully reset</p>

                <div class="success-details">
                    <div class="detail-item">
                        <i class="fas fa-envelope"></i>
                        <span>Confirmation email has been sent to your registered email</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-clock"></i>
                        <span>You can now login with your new password</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-shield-alt"></i>
                        <span>If you didn't request this, contact your security team immediately</span>
                    </div>
                </div>

                <a href="/admin/authentication/adminlogin.html" class="btn btn-primary">
                    <i class="fas fa-sign-in-alt"></i> Go to Login
                </a>
            </div>
        </div>

        <!-- Security Tips -->
        <div class="security-tips">
            <h4><i class="fas fa-lightbulb"></i> Security Tips</h4>
            <ul>
                <li>Never share your password or 2FA codes</li>
                <li>Always use a strong, unique password</li>
                <li>Keep your authenticator app secure</li>
                <li>Save your backup codes in a safe place</li>
            </ul>
        </div>
    </div>

    <script src="/static/js/admin-forgot-password.js"></script>
</body>
</html>
